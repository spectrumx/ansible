---
- hosts: localhost
  tasks:

  - name: Install GPS Server
    apt:
      pkg:
          - gpsd
          - gpsd-clients
      state: present
      update_cache: no

  # - name: Copy dhcpd.conf
  #   copy:
  #     src: "files/dhcpd.conf"
  #     dest: /etc/dhcp/dhcpd.conf
  #     owner: root
  #     group: root
  #   notify: 
  #     - restart dhcpd


  - name: Configure chrony
    blockinfile:
      path: /etc/chrony/chrony.conf
      state: present
      block: |
        allow 192.168.0.0/16
    notify:
      - Restart chrony

  handlers:

  - name: Restart chrony
    systemd:
      name: chrony
      state: restarted
